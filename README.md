# redmine_wiki_lists

## 機能

Wiki ページやチケットの説明にチケットやページの一覧を表示するマクロを提供するプラグインです。

**提供マクロ:**
- `{{wiki_list}}` - Wiki ページの一覧を表形式で表示
- `{{issue_name_link}}` - チケットの件名からリンクを生成
- `{{ref_issues}}` - 条件に一致するチケットの一覧を表示

### wiki_list マクロ

Wiki ページの一覧を表形式で表示します。ページ内のテキストから特定のキーワードを抽出して列として表示できます。

**基本構文:**
```
{{wiki_list([オプション], [カラム指定]...)}}
```

**オプション:**
| オプション | 説明 |
|-----------|------|
| `-p` | 現在のプロジェクトのページのみ表示 |
| `-p=識別子` | 指定プロジェクトのページのみ表示 |
| `-c` | 子ページのみを対象にする |
| `-w=幅` | テーブルの横幅を指定 |

**カラム指定:**
| 指定 | 説明 |
|------|------|
| `+title` | ページタイトル（リンク付き） |
| `+alias` | ページの別名（リダイレクト） |
| `+project` | プロジェクト名 |
| `キーワード` | ページ内からキーワード以降の行末までを抽出 |
| `キーワード\終端` | ページ内からキーワードから終端までを抽出 |

カラム指定には表示名と幅を追加できます: `キーワード|表示名|幅`

**使用例:**
```
{{wiki_list(-c, +title|ページ名, 担当:|担当者)}}
```

### issue_name_link マクロ

チケットの件名からリンクを生成します。チケット番号ではなく、件名でリンクを作成したい場合に便利です。

**基本構文:**
```
{{issue_name_link([プロジェクト識別子:]チケット件名[|表示テキスト])}}
```

**使用例:**
```
{{issue_name_link(機能A実装)}}
{{issue_name_link(other_project:機能B実装|機能Bへのリンク)}}
```

### ref_issues マクロ

条件に一致するチケットの一覧を表示します。カスタムクエリを利用したり、様々なフィルタを指定できます。

**基本構文:**
```
{{ref_issues([オプション]..., [カラム]...)}}
```

**オプション:**
| オプション | 説明 |
|-----------|------|
| `-p` | 現在のプロジェクトのチケットのみ |
| `-p=識別子` | 指定プロジェクトのチケットのみ |
| `-q=クエリ名` | カスタムクエリを使用 |
| `-i=クエリID` | カスタムクエリIDを使用 |
| `-s=キーワード` | 題名で検索 |
| `-d=キーワード` | 説明で検索 |
| `-w=キーワード` | 題名＋説明で検索 |
| `-f:フィールド=値` | フィルタ条件を指定（複数値は `\|` で区切る） |
| `-n=件数` | 表示件数を制限（最大1000） |
| `-t` | 題名をプレーンテキストで表示 |
| `-l` | 題名をリンクで表示 |
| `-c` | 件数のみ表示 |
| `-0` | 0件の場合は何も表示しない |

**使用例:**
```
{{ref_issues(-p, -f:status=新規|進行中, subject, assigned_to)}}
{{ref_issues(-q=未完了チケット, -c)}}
```

## 注意事項

このプラグインは、Wiki マクロを通じて任意の検索条件でチケット情報を表示できるため、信頼できるユーザーのみが利用する環境での使用を推奨します。

## 対応バージョン

- Redmine 5.x（5.1.11 にて動作確認済み）
- Redmine 6.x（6.1.1 にて動作確認済み）

## インストール

Redmine のインストール先はお使いの環境によって異なります。
以下の説明では `/var/lib/redmine` を使用しています。
お使いの環境に合わせて変更してください。

| 環境 | Redmine パス |
|------|-------------|
| apt (Debian/Ubuntu) | `/var/lib/redmine` |
| Docker (公式イメージ) | `/usr/src/redmine` |
| Bitnami | `/opt/bitnami/redmine` |

以下を実行し、Redmine を再起動してください。

```
$ cd /var/lib/redmine/plugins
$ git clone https://github.com/RedminePower/redmine_wiki_lists.git
```

## アンインストール

プラグインフォルダを削除し、Redmine を再起動してください。

```
$ cd /var/lib/redmine/plugins
$ rm -rf redmine_wiki_lists
```

